"use strict";var _createClass=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Array.from||(Array.from=function(){var e=Object.prototype.toString,l=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},i=Math.pow(2,53)-1,h=function(t){var e,n=(e=Number(t),isNaN(e)?0:0!==e&&isFinite(e)?(0<e?1:-1)*Math.floor(Math.abs(e)):e);return Math.min(Math.max(n,0),i)};return function(t){var e=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var n,i=1<arguments.length?arguments[1]:void 0;if(void 0!==i){if(!l(i))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(n=arguments[2])}for(var o,r=h(e.length),a=l(this)?Object(new this(r)):new Array(r),s=0;s<r;)o=e[s],a[s]=i?void 0===n?i(o,s):i.call(n,o,s):o,s+=1;return a.length=r,a}}()),String.prototype.includes||(String.prototype.includes=function(t,e){return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=n.length>>>0;if(0===i)return!1;var o,r,a=0|e,s=Math.max(0<=a?a:i-Math.abs(a),0);for(;s<i;){if((o=n[s])===(r=t)||"number"==typeof o&&"number"==typeof r&&isNaN(o)&&isNaN(r))return!0;s++}return!1}});var FORM_ELEMENTS=["DATALIST","INPUT","OPTGROUP","SELECT","TEXTAREA"];function cloneFormNodes(t,e){for(var n=new Array,i=0;i<t.length;i++){if(t[i].nodeName.includes("#"))n[i]=t[i].cloneNode(!0);else{n[i]=document.createElement(t[i].nodeName);for(var o=0,r=t[i].attributes.length;o<r;o++)n[i].setAttribute(t[i].attributes[o].name,t[i].attributes[o].value);FORM_ELEMENTS.includes(t[i].nodeName)?(n[i].name=e+t[i].name,n[i].id=e+t[i].id):"LABEL"==t[i].nodeName?n[i].setAttribute("for",e+t[i].getAttribute("for")):(t[i].id&&(n[i].id=e+t[i].id),t[i].name&&(n[i].name=e+t[i].name))}if(0<t[i].childNodes.length)for(var a=cloneFormNodes(t[i].childNodes,e),s=0,l=a.length;s<l;s++)n[i].appendChild(a[s])}return n}var Template=function(){function n(t){var i=this;_classCallCheck(this,n);var o=t.baseObject;this.nodes=new Array,this.prefix=t.prefix,this.currentIteration=t.iteration||0,this.classList=[],this.removeButton=t.removeButton||void 0,this.removeButtonContainer=t.removeButtonContainer||void 0;for(var e=0;e<o.classList.length;e++)this.classList.push(o.classList[e]);Array.from(o.childNodes).forEach(function(t,e,n){i.nodes.push(t.cloneNode(!0)),o.removeChild(t)},this)}return _createClass(n,[{key:"instance",value:function(){var t=document.createElement("div"),e=this.removeButton||document.createElement("div"),n=this.prefix+"_"+this.currentIteration.toString()+"-",i=cloneFormNodes(this.nodes,n);for(var o in this.classList)t.classList.add(this.classList[o]);for(var r in this.removeButton?e=this.removeButton.cloneNode(!0):e.innerHTML="Remove",e.getAttribute("type")||e.setAttribute("type","button"),e.classList.add("btn"),0==$(e).filter("*[class^='btn-']").length&&e.classList.add("btn-danger"),e.classList.add("multiform-remove"),t.id=n+"item_container",e.setAttribute("data-itemcontainer",t.id),i)t.appendChild(i[r]);var a=void 0;return this.removeButtonContainer?(a=this.removeButtonContainer.cloneNode(!0),t.appendChild(a),a.appendChild(e)):t.appendChild(e),this.currentIteration++,$(e).click(function(){t.parentElement.removeChild(t)}),t}}]),n}(),multiFormInstance=function(){function r(t,e){var n=this;_classCallCheck(this,r),this.container=t,this.prefix=$(this.container).data("prefix"),this.controlsContainerTemplate=$("#"+this.prefix+"-multiform_controls")[0],this.controlsContainer=void 0,this.addButtonTemplate=$("#"+this.prefix+"-add_button")[0]||void 0,this.addButton=void 0,this.removeButton=void 0,this.removeButtonContainerTemplate=$(this.container).children(".remove-container")[0]||void 0,this.removeButtonTemplate=$(this.removeButtonContainerTemplate||this.container).children(".remove-button")[0]||void 0,this.items=new Array;var i=$("."+this.prefix+"-multiform_item");if(this.postAddFunction=void 0,e&&(this.postAddFunction=e.postAddFunction),this.setupControls(),this.setupRemoveButton(),this.template=new Template({baseObject:this.container,prefix:this.prefix,removeButton:this.removeButton,removeButtonContainer:this.removeButtonContainer}),this.container.appendChild(this.controlsContainer),this.addItem=function(t,e){n.items[t]=new Template({baseObject:e,prefix:n.prefix,removeButton:n.removeButton,removeButtonContainer:n.removeButtonContainer,iteration:t}).instance(),n.container.appendChild(n.items[t]),e.parentElement.removeChild(e)},i.each(this.addItem,this),this.template.currentIteration=i.length,this.container.appendChild(this.template.instance()),$("#"+this.prefix+"-multiform_add").click(function(){n.container.appendChild(n.template.instance()),n.postAddFunction&&n.postAddFunction()}),e){for(var o=0;o<this.container.classList.length+1;o++)this.container.classList.remove(this.container.classList[this.container.classList.length-1]);this.container.classList.add(e.containerClassList)}}return _createClass(r,[{key:"setupControls",value:function(){this.controlsContainerTemplate?(this.controlsContainer=this.controlsContainerTemplate.cloneNode(!0),this.controlsContainerTemplate.parentElement.removeChild(this.controlsContainerTemplate)):(this.controlsContainer=document.createElement("div"),this.controlsContainer.setAttribute("id",this.prefix+"-multiform_controls")),this.addButtonTemplate?$(this.container).find(this.addButtonTemplate).length?(this.addButton=this.addButtonTemplate.cloneNode(!0),this.controlsContainer.appendChild(this.addButton),this.container.removeChild(this.addButtonTemplate)):this.addButton=this.addButtonTemplate:(this.addButton=document.createElement("div"),this.addButton.innerHTML="Add",this.controlsContainer.appendChild(this.addButton)),this.addButton.classList.add("btn"),0==$(this.addButton).filter("*[class^='btn-']").length&&this.addButton.classList.add("btn-success"),this.addButton.setAttribute("id",this.prefix+"-multiform_add"),this.addButton.getAttribute("type")||this.addButton.setAttribute("type","button")}},{key:"setupRemoveButton",value:function(){this.removeButtonTemplate&&this.removeButtonContainerTemplate?(this.removeButtonContainerTemplate.removeChild(this.removeButtonTemplate),this.removeButtonContainerTemplate.parentElement.removeChild(this.removeButtonContainerTemplate),this.removeButton=this.removeButtonTemplate,this.removeButtonContainer=this.removeButtonContainerTemplate):this.removeButtonContainerTemplate?(this.removeButton=document.createElement("div"),this.removeButton.innerHTML="Remove",removeButtonContainerTemplate.removeChild(this.removeButtonTemplate)):this.removeButtonTemplate?(this.removeButton=this.removeButtonTemplate.cloneNode(!0),this.container.removeChild(this.removeButtonTemplate)):(this.removeButton=document.createElement("div"),this.removeButton.innerHTML="Remove"),this.removeButton.classList.add(this.prefix+"-multiform_remove")}}]),r}(),multiForm={};!function(n){multiForm.forms={},n.fn.multiFormTemplate=function(e){this.each(function(){var t=n(this).data("prefix");multiForm.forms[t]=new multiFormInstance(this,e)})}}(jQuery);